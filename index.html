<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Checkerboard</title>

<style>
body {
    margin: 0;
    background: #0a1a2f;
    display: flex;
    justify-content: center;
    font-family: Arial, sans-serif;
}

/* SCALE ROOT */
#scale-root {
    display: flex;
    justify-content: center;
    width: 100vw;
}

/* MAIN CONTAINER */
#container {
    margin-top: 40px;
    text-align: center;
    transform-origin: top center;
}

button {
    cursor: pointer;
}

/* Move controls slightly right */
#top-buttons,
#color-row {
    transform: translateX(20px);
}

/* ---------- TOP BUTTONS ---------- */
#top-buttons {
    margin-bottom: 12px;
}

#top-buttons button {
    font-family: "Comic Sans MS", cursive;
    font-size: 20px;
    padding: 8px 18px;
    margin: 0 6px;
    border-radius: 14px;
    border: 3px solid #222;
    background: linear-gradient(#ffffff, #eaeaea);
    box-shadow: 0 4px 0 #222;
}

#top-buttons button:active {
    transform: translateY(3px);
    box-shadow: 0 1px 0 #222;
}

#top-buttons button.selected {
    background: linear-gradient(#ffd700, #ffcc00);
}

/* ---------- COLOR ROW ---------- */
#color-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 14px;
    margin-bottom: 12px;
}

/* Cartoon Undo / Erase */
#color-row button {
    font-family: "Comic Sans MS", cursive;
    font-size: 16px;
    padding: 8px 16px;
    border-radius: 14px;
    border: 3px solid #222;
    background: linear-gradient(#ffffff, #eaeaea);
    box-shadow: 0 4px 0 #222;
}

#color-row button:active {
    transform: translateY(3px);
    box-shadow: 0 1px 0 #222;
}

/* ---------- COLOR BUTTONS ---------- */
.color-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 3px solid #0a1a2f;
    cursor: pointer;
}

.color-btn.selected {
    border-color: white;
}

/* ---------- BOARD + LABELS ---------- */
#board-wrapper {
    display: grid;
    grid-template-columns: 45px auto;
    grid-template-rows: auto 45px;
    justify-content: center;
}

/* Rank labels */
#rank-labels {
    display: grid;
    grid-template-rows: repeat(8, 75px);
    color: white;
    font-family: "Comic Sans MS", cursive;
    font-size: 22px;
    align-items: center;
    justify-items: center;
}

/* File labels */
#file-labels {
    grid-column: 2;
    display: grid;
    grid-template-columns: repeat(8, 75px);
    color: white;
    font-family: "Comic Sans MS", cursive;
    font-size: 22px;
    align-items: center;
    justify-items: center;
}

/* ---------- BOARD ---------- */
#board {
    display: grid;
    grid-template-columns: repeat(8, 75px);
    grid-template-rows: repeat(8, 75px);
}

.square {
    width: 75px;
    height: 75px;
    border: 1px solid black;
    position: relative;
    user-select: none;
}

/* Chess.com colors */
.white { background: #eeeed2; }
.black { background: #769656; }

/* ---------- LETTER ---------- */
.letter {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: "Comic Sans MS", "Segoe Script", "Bradley Hand", cursive;
    font-size: 26px;
    color: #d81f1f;
    pointer-events: none;
    z-index: 3;
}

/* ---------- HIGHLIGHT ---------- */
.highlight {
    position: absolute;
    inset: 0;
    opacity: 0.45;
    z-index: 2;
}

/* ---------- EDIT INPUT ---------- */
.edit-input {
    position: absolute;
    inset: 0;
    z-index: 5;
    font-family: "Comic Sans MS", "Segoe Script", "Bradley Hand", cursive;
    font-size: 26px;
    text-align: center;
    border: none;
    outline: none;
    background: transparent;
    color: #d81f1f;
}
</style>
</head>

<body>

<div id="scale-root">
<div id="container">

    <!-- C R T -->
    <div id="top-buttons">
        <button onclick="selectPattern('C')" id="btnC">C</button>
        <button onclick="selectPattern('R')" id="btnR">R</button>
        <button onclick="selectPattern('T')" id="btnT">T</button>
    </div>

    <!-- Undo / Colors / Erase -->
    <div id="color-row">
        <button onclick="undoEdits()">Undo</button>

        <div class="color-btn" style="background:#ff9999" onclick="setColor('#ff9999',this)"></div>
        <div class="color-btn" style="background:#cfa6ff" onclick="setColor('#cfa6ff',this)"></div>
        <div class="color-btn" style="background:#9fd6ff" onclick="setColor('#9fd6ff',this)"></div>
        <div class="color-btn selected" style="background:#ffd700" onclick="setColor('#ffd700',this)"></div>
        <div class="color-btn" style="background:#ffb347" onclick="setColor('#ffb347',this)"></div>
        <div class="color-btn" style="background:#9be29b" onclick="setColor('#9be29b',this)"></div>

        <button onclick="eraseHighlights()">Erase</button>
    </div>

    <!-- Board + labels -->
    <div id="board-wrapper">
        <div id="rank-labels"></div>
        <div id="board"></div>
        <div id="file-labels"></div>
    </div>

</div>
</div>

<script>
const board = document.getElementById("board");
const rankLabels = document.getElementById("rank-labels");
const fileLabels = document.getElementById("file-labels");

const patterns = {
    C: Array(8).fill("TCRTCRTC".split("")),
    R: Array(8).fill("RTCRTCRT".split("")),
    T: Array(8).fill("CRTCRTCR".split(""))
};

let currentPattern = "C";
let editedLetters = {};
let highlights = {};
let currentColor = "#ffd700";

let lastClickTime = 0;
let lastSquare = null;
const DOUBLE_CLICK_DELAY = 300;

/* Labels */
for (let i = 8; i >= 1; i--) {
    const d = document.createElement("div");
    d.textContent = i;
    rankLabels.appendChild(d);
}

"abcdefgh".split("").forEach(l => {
    const d = document.createElement("div");
    d.textContent = l;
    fileLabels.appendChild(d);
});

/* Controls */
function selectPattern(p) {
    currentPattern = p;
    document.querySelectorAll("#top-buttons button").forEach(b => b.classList.remove("selected"));
    document.getElementById("btn"+p).classList.add("selected");
    drawLetters();
}

function setColor(color, el) {
    currentColor = color;
    document.querySelectorAll(".color-btn").forEach(c => c.classList.remove("selected"));
    el.classList.add("selected");
}

function undoEdits() {
    editedLetters = {};
    drawLetters();
}

function eraseHighlights() {
    Object.values(highlights).forEach(h => h.remove());
    highlights = {};
}

/* Board */
function drawBoard() {
    board.innerHTML = "";
    for (let r = 0; r < 8; r++) {
        for (let c = 0; c < 8; c++) {
            const sq = document.createElement("div");
            sq.className = "square " + ((r+c)%2===0 ? "white":"black");
            sq.dataset.key = r+","+c;

            sq.addEventListener("click", () => handleClick(sq));

            const letter = document.createElement("div");
            letter.className = "letter";
            sq.appendChild(letter);

            board.appendChild(sq);
        }
    }
    drawLetters();
}

function handleClick(sq) {
    const now = Date.now();
    const isDouble = sq === lastSquare && (now - lastClickTime) < DOUBLE_CLICK_DELAY;
    lastClickTime = now;
    lastSquare = sq;

    if (isDouble) editSquare(sq);
    else toggleHighlight(sq);
}

function drawLetters() {
    document.querySelectorAll(".square").forEach(sq => {
        const [r, c] = sq.dataset.key.split(",");
        sq.querySelector(".letter").textContent =
            editedLetters[sq.dataset.key] ?? patterns[currentPattern][r][c];
    });
}

function toggleHighlight(sq) {
    const key = sq.dataset.key;
    if (highlights[key]) {
        highlights[key].remove();
        delete highlights[key];
    } else {
        const h = document.createElement("div");
        h.className = "highlight";
        h.style.background = currentColor;
        sq.appendChild(h);
        highlights[key] = h;
    }
}

function editSquare(sq) {
    if (sq.querySelector(".edit-input")) return;
    const key = sq.dataset.key;

    const input = document.createElement("input");
    input.className = "edit-input";
    input.value = sq.querySelector(".letter").textContent;

    sq.appendChild(input);
    input.focus();
    input.select();

    input.addEventListener("keydown", e => {
        if (e.key === "Enter") {
            editedLetters[key] = input.value;
            input.remove();
            drawLetters();
        }
    });

    input.addEventListener("blur", () => {
        input.remove();
        drawLetters();
    });
}

/* Responsive scaling with orientation detection */
function scaleToScreen() {
    const container = document.getElementById("container");

    const BASE_WIDTH = 800;
    const BASE_HEIGHT = 900;

    const vw = window.innerWidth;
    const vh = window.innerHeight;

    const isPortrait = vh > vw;
    let scale = isPortrait ? vw / BASE_WIDTH : vh / BASE_HEIGHT;
    scale = Math.min(scale, 1);

    container.style.transform = `scale(${scale})`;
}

window.addEventListener("resize", scaleToScreen);
window.addEventListener("orientationchange", scaleToScreen);

drawBoard();
selectPattern("C");
scaleToScreen();
</script>

</body>
</html>
